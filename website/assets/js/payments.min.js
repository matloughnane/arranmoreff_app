function verifyButton(){document.getElementById("payp_btn").style.display="none",document.getElementById("ferry_btn").style.display="block";var e='Check For Ferry <span id="loading_span"></span>';document.getElementById("validate_ferry").innerHTML=e}function requireInput(e){switch(e){case"ticket_type":document.getElementById("warning_ticket_type").style.display="block",document.getElementById("warning_ticket_type").innerHTML="<div class='warning margin_ticket'>Please select a ticket type.</div>";break;case"name":document.getElementById("warning_name").style.display="block",document.getElementById("warning_name").innerHTML="<div class='warning'>Please enter a "+e+".</div>";break;case"number":document.getElementById("warning_number").style.display="block",document.getElementById("warning_number").innerHTML="<div class='warning'>Please enter a "+e+".</div>";break;case"car_details":document.getElementById("warning_car_details").style.display="block",document.getElementById("warning_car_details").innerHTML="<div class='warning'>Please enter your car reg num.</div>";break;case"car_model":break;case"outward_journey":document.getElementById("warning_journey_type").style.display="block",document.getElementById("warning_journey_type").innerHTML="<div class='warning'>Please select an outward journey.</div>";break;case"outward_date":document.getElementById("warning_outward_date").style.display="block",document.getElementById("warning_outward_date").innerHTML="<div class='warning'>Please select a valid date.</div>";break;case"outward_time":document.getElementById("warning_outward_time").style.display="block",document.getElementById("warning_outward_time").innerHTML="<div class='warning'>Please select a ferry time.</div>";break;case"return_date":document.getElementById("warning_return_date").style.display="block",document.getElementById("warning_return_date").innerHTML="<div class='warning'>Please select a valid return date.</div>";break;case"return_time":document.getElementById("warning_return_time").style.display="block",document.getElementById("warning_return_time").innerHTML="<div class='warning'>Please select a ferry time.</div>";break;default:console.log("no requirements")}}function dateisinpast(){document.getElementById("warning_return_date").style.display="block";var e="<div class='warning'>Pick a return date after your outward sailing.</div>";document.getElementById("warning_return_date").innerHTML=e}function timeisinpast(){document.getElementById("warning_return_time").style.display="block";var e="<div class='warning'>Pick a return time after your outward sailing.</div>";document.getElementById("warning_return_time").innerHTML=e}function getTimesForDate(e,t,n){var a={};"select_journey"==t||firebaseRef.on("value",function(r){a=r.val();var i=e,d=(getPrettyDate(e),checkDayRange(i)),l=(getPrettyTime(i),d.substr(0,d.indexOf(","))),s=d.substr(d.lastIndexOf(",")+1,d.length),c=checkCancelledFerries(a,t,i),u=checkExtraFerries(a,t,i),m=findDatabaseRef(a,t,s,l,c,u);constructSelect(m,n)})}function constructSelect(e,t){var n="<option value='select_time'>Select A Time</option>";for(i=0;i<e.length;i++)n+="<option value='"+e[i]+"'>"+e[i]+"</option>";document.getElementById(t).innerHTML=n}function findDatabaseRef(e,t,n,a,r,i){for(key in e)if(key==t){var d=e[key];for(key in d)if(key==n){var l=d[key],s="";for(key in l)if("fri"==a?(a="wk",s="fri"):"sat"==a&&(a="wk",s="sat"),key==a){var c=l[key],u=[];for(key in c)u.push(c[key].time);if("fri"==s){var m=l.fri;if("undefined"==m);else for(key in m)u.push(m[key].time)}if("sat"==s){var m=l.sat;if("undefined"==m);else for(key in m)u.push(m[key].time)}u.sort(function(e,t){return new Date("1970/01/01 "+e)-new Date("1970/01/01 "+t)});var o=compareCancelArrays(u,r),y=compareExtraArray(o,i);return y.sort(function(e,t){return new Date("1970/01/01 "+e)-new Date("1970/01/01 "+t)}),y}}}}function checkCancelledFerries(e,t,n){if("da"==t)var a=e.cancel_ferry.da;else var a=e.cancel_ferry.db;var r=[];for(key in a)n==a[key].date&&r.push(a[key].time);return r}function checkExtraFerries(e,t,n){if("da"==t)var a=e.extra_ferry.da;else var a=e.extra_ferry.db;var r=[];for(key in a){var i=getInputDate(a[key].date);getInputDate(n)==i&&r.push(a[key].time)}return r}function compareExtraArray(e,t){for(var n=e,a=0;a<t.length;a++)n.push(t[a]);return n}function compareCancelArrays(e,t){for(var n=0;n<t.length;n++)for(var a=0;a<e.length;a++)if(t[n]==e[a]){var r=e.indexOf(e[a]);e.splice(r,1)}return e}function checkDayRange(e){var t=getPrettyDate(e),n=t.substr(0,t.indexOf(",")),a=new Date(e),r=a.getYear();1900>r&&(r+=1900);var i=a.getMonth()+1,a=a.getDate();if("Sun"==n||"Domh"==n)var d="sun";else if("Fri"==n||"Aoine"==n)var d="fri";else if("Sat"==n||"Sath"==n)var d="sat";else var d="wk";if(5>i)var l="jantoapr";else if(5==i)var l="may";else if(i>5&&9>i)var l="juntoaug";else if(i>8&&11>i)var l="septooct";else if(i>10)var l="novtodec";return d+","+l}function getPrettyTime(e){var t=new Date(e),n=lessThanTen(t.getHours()),a=lessThanTen(t.getMinutes()),r=(lessThanTen(t.getSeconds()),""+n+":"+a);return r}function lessThanTen(e){if(10>e)var t="0"+e;else var t=e;return t}function getPrettyDate(e){var t=new Date(e),n=t.getYear(),a=t.getMonth()+1,e=t.getDate(),r=t.getDay();1e3>n&&(n+=1900),9>e&&(e="0"+e);var i=day_array[r]+", "+e+" "+month_array[a-1]+" "+n;return i}function getInputDate(e){var t=new Date(e),n=t.getYear(),a=t.getMonth()+1,r=t.getDate();1e3>n&&(n+=1900),9>=a&&(a="0"+a),9>=r&&(r="0"+r);var i=n+"-"+a+"-"+r;return i}var day_array=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_array=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],car_family_price="40.50",car_driver_price="27.00",adult_price="13.50",student_price="9.00",child_price="6.30",da_text="Departing Arranmore",db_text="Departing Burtonport",loading_svg='<svg width="36" height="10"> <rect class="white_svg" width="10" height="10" x="0" y="0" rx="3" ry="3"><animate attributeName="width" values="0;10;10;10;0" dur="1000ms" repeatCount="indefinite"/><animate attributeName="height" values="0;10;10;10;0" dur="1000ms" repeatCount="indefinite"/><animate attributeName="x" values="5;0;0;0;5" dur="1000ms" repeatCount="indefinite"/><animate attributeName="y" values="5;0;0;0;5" dur="1000ms" repeatCount="indefinite"/></rect><rect class="white_svg" width="10" height="10" x="13" y="0" rx="3" ry="3"><animate attributeName="width" values="0;10;10;10;0" begin="300ms" dur="1000ms" repeatCount="indefinite"/><animate attributeName="height" values="0;10;10;10;0" begin="300ms" dur="1000ms" repeatCount="indefinite"/><animate attributeName="x" values="18;13;13;13;18" begin="300ms" dur="1000ms" repeatCount="indefinite"/><animate attributeName="y" values="5;0;0;0;5" begin="300ms" dur="1000ms" repeatCount="indefinite"/></rect><rect class="white_svg" width="10" height="10" x="36" y="0" rx="3" ry="3"><animate attributeName="width" values="0;10;10;10;0" begin="500ms" dur="1000ms" repeatCount="indefinite"/><animate attributeName="height" values="0;10;10;10;0" begin="500ms" dur="1000ms" repeatCount="indefinite"/><animate attributeName="x" values="31;26;26;26;31" begin="500ms" dur="1000ms" repeatCount="indefinite"/><animate attributeName="y" values="5;0;0;0;5" begin="500ms" dur="1000ms" repeatCount="indefinite"/></rect></svg>';$("#ticketPicker").change(function(){var e=document.getElementById("ticketPicker").value;switch(e){case"car_family":document.getElementById("price_grid").style.display="block","none"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="block"),"block"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="block"),document.getElementById("ticket_price").innerHTML="€"+car_family_price;break;case"car_driver":document.getElementById("price_grid").style.display="block","none"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="block"),"block"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="block"),document.getElementById("ticket_price").innerHTML="€"+car_driver_price;break;case"adult":document.getElementById("price_grid").style.display="block","none"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="none"),"block"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="none"),document.getElementById("ticket_price").innerHTML="€"+adult_price;break;case"student":document.getElementById("price_grid").style.display="block","none"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="none"),"block"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="none"),document.getElementById("ticket_price").innerHTML="€"+student_price;break;case"child":document.getElementById("price_grid").style.display="block","none"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="none"),"block"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="none"),document.getElementById("ticket_price").innerHTML="€"+child_price;break;case"test":document.getElementById("price_grid").style.display="block","none"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="none"),"block"==$("#car_details_grid").css("display")&&(document.getElementById("car_details_grid").style.display="none"),document.getElementById("ticket_price").innerHTML="€"+test_price;break;default:console.log("none_selected"),document.getElementById("price_grid").style.display="none"}verifyButton()}),$("#journeyPicker").change(function(){var e=document.getElementById("journeyPicker").value;document.getElementById("return_journey").innerHTML="da"==e?db_text:"db"==e?da_text:"Select Outward Journey",$(".js__datepicker").val(""),document.getElementById("first_sail_times").innerHTML="<option value='time'>Select a Date</option>",document.getElementById("return_sail_times").innerHTML="<option value='time'>Select a Date</option>",verifyButton()}),$("#first_sail_date").change(function(){var e=document.getElementById("first_sail_date").value,t=document.getElementById("journeyPicker").value;getTimesForDate(e,t,"first_sail_times"),verifyButton()}),$("#return_sail_date").change(function(){var e=document.getElementById("return_sail_date").value,t=document.getElementById("journeyPicker").value;if("da"==t)var n="db";else if("db"==t)var n="da";getTimesForDate(e,n,"return_sail_times"),verifyButton()}),$("#first_sail_times").change(function(){verifyButton()}),$("#return_sail_times").change(function(){verifyButton()}),$("#validate_ferry").click(function(){document.getElementById("loading_span").innerHTML=loading_svg,document.getElementById("warning_ticket_type").style.display="none",document.getElementById("warning_name").style.display="none",document.getElementById("warning_number").style.display="none",document.getElementById("warning_car_details").style.display="none",document.getElementById("warning_journey_type").style.display="none",document.getElementById("warning_outward_date").style.display="none",document.getElementById("warning_outward_time").style.display="none",document.getElementById("warning_return_date").style.display="none",document.getElementById("warning_return_time").style.display="none",document.getElementById("warning_errors").style.display="none";{var e=0,t=document.getElementById("ticketPicker").value,n=document.getElementById("name_input").value,a=document.getElementById("number_input").value,r=document.getElementById("car_details_input").value;document.getElementById("special_reqs").value}"select_ticket"==t&&(requireInput("ticket_type"),e++),""==n&&(requireInput("name"),e++),""==a&&(requireInput("number"),e++),("car_family"==t||"car_driver"==t)&&""==r&&(requireInput("car_details"),e++);var i=document.getElementById("journeyPicker").value,d=document.getElementById("first_sail_date").value,l=document.getElementById("return_sail_date").value,s=document.getElementById("first_sail_times").value,c=document.getElementById("return_sail_times").value;"select_journey"==i&&(requireInput("outward_journey"),e++),""==d&&(requireInput("outward_date"),e++),""==l&&(requireInput("return_date"),e++);var u=new Date(d),m=new Date(l);u>m&&(dateisinpast(),e++),("select_time"==s||"time"==s)&&(requireInput("outward_time"),e++),("select_time"==c||"time"==c)&&(requireInput("return_time"),e++);var o=""+d+","+s,y=""+l+","+c,_=new Date(o),g=new Date(y);if(_>g&&(timeisinpast(),e++),0==e){if("db"==i)var p="Departing Burtonport",v="Departing Arranmore";else var p="Departing Arranmore",v="Departing Burtonport";switch(t){case"car_family":var f=car_family_price;break;case"car_driver":var f=car_driver_price;break;case"adult":var f=adult_price;break;case"student":var f=student_price;break;case"child":var f=child_price;break;case"test":var f=test_price;break;default:console.log("none_selected")}var k='<form name="_xclick" action="https://www.paypal.com/uk/cgi-bin/webscr" method="post"><input type="hidden" name="cmd" value="_xclick"><input type="hidden" name="business" value="seamusboyle4@eircom.net"><input type="hidden" name="currency_code" value="EUR"><input type="hidden" name="item_name" value="'+p+" on "+d+" at "+s+", "+v+" on "+l+" at "+c+'."><input type="hidden" name="amount" value="'+f+'"><input type="image" src="assets/img/pp_buy_large.png" border="0" name="submit" alt="Make payments with PayPal">';document.getElementById("ferry_btn").style.display="none",document.getElementById("payp_btn").style.display="block",document.getElementById("payp_btn").innerHTML=k}else document.getElementById("validate_ferry").innerHTML="Check Ferry Again <span id='loading_span'></span>",document.getElementById("warning_errors").innerHTML="<div class='warning'>Check your details above, then try again.</div>"}),$("#payp_btn").click(function(){var e=new Firebase("https://amber-fire-55.firebaseio.com/temp_tickets/"),t=document.getElementById("ticketPicker").value,n=document.getElementById("name_input").value,a=document.getElementById("number_input").value,r=document.getElementById("car_details_input").value,i=document.getElementById("special_reqs").value,d=document.getElementById("journeyPicker").value,l=document.getElementById("first_sail_date").value,s=document.getElementById("return_sail_date").value,c=document.getElementById("first_sail_times").value,u=document.getElementById("return_sail_times").value;e.push({type_of_ticket:t,name:n,number:a,car_details:r,requirements:i,paid:"no",ticket:{outbound:d,outbound_date:l,outbound_time:c,return_date:s,return_time:u}})});var firebaseRef=new Firebase("https://amber-fire-55.firebaseio.com/timetable4/");